-- 혹시 있으면 테이블 제거
DROP TABLE C_IMAGE
DROP TABLE C_NEWS
-- 이미지 저장 테이블 생성
CREATE TABLE C_IMAGE(
SEARCH_WORD VARCHAR2(4000) PRIMARY KEY,
HREF VARCHAR2(4000),
ROOT VARCHAR2(4000),
START_DATE VARCHAR2(8),
END_DATE VARCHAR2(8)
);
-- 뉴스 저장 테이블 생성
CREATE TABLE C_NEWS(
SEARCH_WORD VARCHAR2(4000) PRIMARY KEY,
TITLE VARCHAR2(4000),
HREF VARCHAR2(4000),
START_DATE VARCHAR2(8),
END_DATE VARCHAR2(8)
);


-- INSERT IMAGE 프로시저
create or replace PROCEDURE INSERT_IMAGE
(
  P_SEARCH_WORD IN C_IMAGE.SEARCH_WORD%TYPE
, P_HREF IN C_IMAGE.HREF%TYPE
, P_ROOT IN C_IMAGE.ROOT%TYPE
, P_START_DATE IN C_IMAGE.START_DATE%TYPE
, P_END_DATE IN C_IMAGE.END_DATE%TYPE
) AS
BEGIN
    INSERT INTO C_IMAGE VALUES(P_SEARCH_WORD, P_HREF, P_ROOT, P_START_DATE, P_END_DATE);
    COMMIT;
END INSERT_IMAGE;


-- INSERT NEWS 프로시저
create or replace PROCEDURE INSERT_NEWS
(
  P_SEARCH_WORD IN C_NEWS.SEARCH_WORD%TYPE
, P_TITLE IN C_NEWS.TITLE%TYPE
, P_HREF IN C_NEWS.HREF%TYPE
, P_START_DATE IN C_NEWS.START_DATE%TYPE
, P_END_DATE IN C_NEWS.END_DATE%TYPE
) AS
BEGIN
    INSERT INTO C_NEWS VALUES(P_SEARCH_WORD, P_TITLE, P_HREF, P_START_DATE, P_END_DATE);
    COMMIT;
END INSERT_NEWS;


--SELECT WHERE IMAGE 프로시저
CREATE OR REPLACE PROCEDURE SELECT_IMAGE
(
  P_SEARCH_WORD IN C_IMAGE.SEARCH_WORD%TYPE
, P_CURSOR OUT SYS_REFCURSOR
) AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT SEARCH_WORD, HREF, ROOT, START_DATE, END_DATE
        FROM C_IMAGE
        WHERE SEARCH_WORD = P_SEARCH_WORD;
END SELECT_IMAGE;


-- SELECT WHERE NEWS 프로시저
CREATE OR REPLACE PROCEDURE SELECT_NEWS
(
  P_SEARCH_WORD IN C_NEWS.SEARCH_WORD%TYPE
, P_CURSOR OUT SYS_REFCURSOR
) AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT SEARCH_WORD, TITLE, HREF, START_DATE, END_DATE
        FROM C_NEWS
        WHERE SEARCH_WORD = P_SEARCH_WORD;
END SELECT_NEWS;

create or replace PROCEDURE SELECT_IMAGE_SW
(
  P_SEARCH_WORD IN C_IMAGE.SEARCH_WORD%TYPE
, P_CURSOR OUT SYS_REFCURSOR
) AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT 'C_IMAGE', SEARCH_WORD, START_DATE, END_DATE
        FROM C_IMAGE;
END SELECT_IMAGE_SW;


CREATE OR REPLACE PROCEDURE SELECT_NEWS_SW
(
  P_SEARCH_WORD IN C_NEWS.SEARCH_WORD%TYPE
, P_CURSOR OUT SYS_REFCURSOR
) AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT 'C_NEWS', SEARCH_WORD, START_DATE, END_DATE
        FROM C_NEWS;
END SELECT_NEWS_SW;


drop primary key;

alter table c_image
add constraint p primary key(search_word,start_date,end_date);

alter table c_news
drop primary key;

alter table c_news
add constraint pky primary key(search_word,start_date,end_date);

